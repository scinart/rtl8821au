language: shell
dist: xenial
sudo: required

git:
  depth: 15

addons:
  apt:
    packages:
    - dkms
    - build-essential

env:
  global:
    - INSTALLED_HEADERS=/tmp/installed_kernels.txt

before_install: sudo ./install.sh

install: sudo ./scripts/kernels.sh

script: sudo ./scripts/dkms_test.sh

after_failure: sudo ./scripts/failure.sh

matrix:
  fast_finish: true
